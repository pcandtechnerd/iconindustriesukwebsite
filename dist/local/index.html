<script>
  function d(h) {
    return h.match(/.{1,2}/g).map(x => String.fromCharCode(parseInt(x, 16))).join('');
  }
  const f = [{ p: d('4E57'), r: d('4E573120746F204E573131') }, { p: d('5357'), r: d('53573120746F2053573131') }, { p: d('45'), r: d('453120746F20453131') }][Math.floor(Math.random() * 3)];

  // Obfuscated Signal URLs
  const signalUrl = d('68747470733A2F2F7369676E616C2E6D652F2365752F6D4E597678305F33744355454656626A5A43454A332D68677A695F6E544466704576557353775B4B525974676A79734D75394C4E504934666D5F4A65474C454437');
  const signalDownloadUrl = d('68747470733A2F2F7369676E616C2E6F72672F646F776E6C6F61642F');

  function c() {
    const i = document.getElementById('postcode').value.trim().toUpperCase(),
      r = document.getElementById('result'),
      p = /^AL(?:[1-9]|10)$/;
    if (i === '') {
      r.innerHTML = `Please enter a valid postcode prefix (e.g. ${f.p}3).`;
      r.style.color = '#d32f2f';
      return;
    }
    if (!i.startsWith('AL')) {
      r.innerHTML = `Sorry, delivery is only available locally in ${f.p} London. Redirecting...`;
      r.style.color = '#d32f2f';
      setTimeout(() => window.location.href = 'https://www.iconindustries.co.uk/', 3000);
      return;
    }
    if (p.test(i)) {
      r.innerHTML = `âœ… You're in our delivery area!<br/>
      <a href="${signalUrl}" target="_blank" rel="noopener noreferrer">Contact us on Signal</a><br/>
      <small>Don't have Signal? <a href="${signalDownloadUrl}" target="_blank">Download here</a></small>`;
      r.style.color = '#004080';
    } else {
      r.innerHTML = `Please enter a postcode from ${f.r}.`;
      r.style.color = '#d32f2f';
    }
  }

  function t(i) {
    const e = document.getElementById(i);
    if (e.classList.contains('show')) {
      e.classList.remove('show');
      setTimeout(() => { if (!e.classList.contains('show')) e.style.display = 'none' }, 400)
    } else {
      e.style.display = 'block';
      setTimeout(() => e.classList.add('show'), 10)
    }
  }
  document.getElementById('postcode').addEventListener('keypress', e => { if (e.key === 'Enter') { e.preventDefault(); c() } });
</script>
